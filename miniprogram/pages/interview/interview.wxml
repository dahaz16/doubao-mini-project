<view class="container">
  <!-- Top Section: Avatar & AI Message -->
  <view class="top-section">
    <view class="avatar-wrapper">
      <view class="avatar-placeholder">å¤´åƒ</view>
    </view>
    
    <view class="chat-bubble {{status === 'thinking' ? 'thinking-bubble' : ''}}">
      <text wx:if="{{status !== 'thinking'}}">{{aiMessage}}</text>
      <text wx:else>æ€è€ƒä¸­...</text>
    </view>
    
    <!-- Debug Info (Moved to below AI Bubble) -->
    <view class="debug-info" style="font-size: 20rpx; color: #999; margin-top: 10rpx; text-align: left;">
      {{micStatus}}
    </view>
  </view>

  <!-- Middle Section: User Streaming Text -->
  <view class="content-section">
    <view class="user-feedback" wx:if="{{userInput || status === 'recording'}}">
      <text>{{userInput}}</text>
      <view class="cursor" wx:if="{{status === 'recording'}}">|</view>
    </view>
  </view>

  <!-- Bottom Section: Controls -->
  <view class="controls-section">
    <!-- Idle State: Big Narrate Button -->
    <view class="controls" wx:if="{{status === 'idle'}}">
    
      <view class="mic-button-wrapper" 
            bindtouchstart="startRecording" 
            bindtouchend="finishRecording">
        <image class="mic-icon" src="../../images/mic.png" wx:if="{{hasIcon}}"></image>
        <text>ğŸ¤ è®²è¿°</text>
      </view>
    </view>

    <!-- Recording State: Waveform and Actions -->
    <view class="recording-controls" wx:if="{{status === 'recording'}}">
      <view class="cancel-btn" bindtap="cancelRecording">âœ•</view>
      
      <view class="waveform-container">
        <view class="waveform-bar"></view>
        <view class="waveform-bar"></view>
        <view class="waveform-bar"></view>
        <view class="waveform-bar"></view>
        <view class="timer">{{recordingTime}}</view>
      </view>

      <view class="finish-btn" bindtap="finishRecording">â†‘</view>
    </view>

    <!-- Thinking/Wait State -->
    <view class="thinking-controls" wx:if="{{status === 'thinking'}}">
      <view class="wait-btn">è¯·ç¨ç­‰</view>
    </view>
  </view>

  <!-- Debug Console -->
  <scroll-view scroll-y class="debug-console" style="height: 150rpx; width: 100%; background: #000; color: #0f0; font-size: 16rpx; padding: 10rpx; margin-top: 20rpx;">
    <view wx:for="{{debugLogs}}" wx:key="*this">{{item}}</view>
  </scroll-view>
</view>
