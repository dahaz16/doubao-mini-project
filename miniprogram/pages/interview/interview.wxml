<view class="container">
  <!-- Top 区：AI 虚拟形象 -->
  <view class="top-section">
    <image class="ai-avatar" src="/images/AI_Avatar.png" mode="aspectFit"></image>
  </view>

  <!-- Middle 区：AI 字幕气泡 -->
  <view class="middle-section">
    <view class="ai-subtitle-bubble">
      <text class="ai-subtitle-text {{status === 'thinking' ? 'thinking' : ''}}">
        {{status === 'thinking' ? '思考中...' : aiMessage}}
      </text>
    </view>
  </view>

  <!-- Bottom 区：用户输入区 -->
  <view class="bottom-section">
    <!-- 用户字幕气泡（录音时显示实时识别结果）-->
    <view class="user-subtitle-bubble" wx:if="{{userInput && status === 'recording'}}">
      <text class="user-subtitle-text">{{userInput}}</text>
    </view>

    <!-- 录音状态：音频指示器（声波 + 倒计时）-->
    <view class="voice-indicator" wx:if="{{status === 'recording'}}">
      <view class="voice-waveform">
        <view class="wave-bar"></view>
        <view class="wave-bar"></view>
        <view class="wave-bar"></view>
        <view class="wave-bar"></view>
        <view class="wave-bar"></view>
      </view>
      <text class="voice-timer">{{recordingTime}}</text>
    </view>

    <!-- 控制按钮组 -->
    <view class="control-buttons">
      <!-- 默认状态：切换键盘按钮（左）+ 讲述按钮（右）-->
      <button wx:if="{{status === 'idle'}}" class="circle-btn" bindtap="handleSwitchToKeyboard">
        <image src="/images/switch_to_keyboard_btn.png" mode="aspectFit"></image>
      </button>
      <button wx:if="{{status === 'idle'}}" class="narration-btn" bindtap="handleMicToggle">讲述</button>

      <!-- 录音状态：取消按钮（左）+ 发送按钮（右）-->
      <button wx:if="{{status === 'recording'}}" class="circle-btn" bindtap="handleCancelRecording">
        <image src="/images/cancel_speak_btn.png" mode="aspectFit"></image>
      </button>
      <button wx:if="{{status === 'recording'}}" class="circle-btn send-btn" bindtap="handleMicToggle">
        <image src="/images/send_msg_btn.png" mode="aspectFit"></image>
      </button>

      <!-- 思考中状态：禁用按钮 -->
      <button wx:if="{{status === 'thinking'}}" class="circle-btn disabled" disabled>
        <image src="/images/switch_to_keyboard_btn_disabled.png" mode="aspectFit"></image>
      </button>
      <button wx:if="{{status === 'thinking'}}" class="narration-btn-disabled" disabled>请稍等</button>
    </view>
  </view>
</view>
