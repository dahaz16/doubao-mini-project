# 管理后台需求（用户采访详情页）
#1. 工作手记#

### 页面整体
* 页面从上一级采访库的某个用户的 “查看详情” 按钮进入，带入 user_id，页面中仅展示该用户的记录，不同用户数据不混杂。
* 分页加载规则：50 条 / 页，默认展示第 1 页。
* 列表排序规则：按时间字段的升序排列，即从早到晚的顺序展示数据。

### 数据筛选
* 筛选信息功能：用户可通过勾选 / 取消勾选数据方类型，控制列表是否展示对应数据。
* 筛选时间功能：时间选择器可精确到秒，支持选择年月日及开始、结束时间以框定记录时间范围；页面默认展示当前日期的记录，时间范围为 00:00:00-23:59:59。

### 列表字段定义
1. 记录选择功能：每条数据前有单选框可选中，表头单选框为 “全选本页” 交互；
2. “ 数据方”字段展示规则：
   * “啊拓” == 用户本轮的讲述原文 user_original_text （“啊拓”为 users 表中此 user_id 对应的 user_name）
   * “念念” == 访谈者 LLM 本轮的输出 - 即回复（intv_llm_output）
   * intv_input == 调用访谈者 LLM 时本轮的输入（intv_llm_input）
   * stn_input == 调用速记员 LLM 时本轮的输入（stn_llm_input）
   * stn_output == 速记员 LLM 本轮的输出（stn_llm_output）
   * dir_input == 调用导演 LLM 时本轮的输入（dir_llm_input）
   * “导演提示” == 导演 LLM 本轮的输出（dir_llm_output） 
3. 日期字段格式：仅展示 “月 - 日”，不含年份。
4. 时间字段格式：24 小时制，精确到秒，如 “18:00:32”。
5. 音频字段功能：仅 “啊拓” 和 “念念” 的数据可能有可播放音频，判断依据为讲述原文中是否有关联音频文件链接；用户语音输入时有链接则音频可点击播放，打字输入无链接则音频置灰不可点；其他数据方的音频均不可点。
6. 内容字段展示规则：
   * “啊拓”、“念念” 和 “导演提示” 的内容直接展示原文；
   * intv_input、stn_input、stn_output、dir_input 类型的内容需点击 “点击查看” 按钮，弹出弹窗展示 json 或简短文字。
7. session_id 字段展示：对应 narrow_status 表中该轮对话的 session_id。
8. model：当前使用的是哪个大模型（“用户”记录对应 intv 的大模型）。取本次请求 model_id 对应 base_models 表中的 model_name_cn。
9. tokens 字段展示：格式为 “总 tokens 值 (prt:prompt_tokens 值，cp:completion_tokens 值，cch:cached_tokens 值)”，数据取自 LLM_processed 表的 total_tokens、prompt_tokens、completion_tokens、cached_tokens 字段。
10. prompt 字段展示： 数据取自 prompt_config 表。格式为 “prompt_id (llm_type)”，“啊拓” 也需按此格式展示。
11. 操作栏 “复制文本” 功能：直接展示内容的，复制该内容到剪贴板；需点击 “点击查看” 弹窗展示的，复制弹窗中的 JSON 文本。

### 其他
为了方便观测整体采访情况，在前端 UI 上使用以下字体颜色：
* “数据方”为“啊拓”、“念念”、 “导演提示”时，“数据方”/“ 日期”/“时间”/ “内容”的字体展示颜色为：#373737（导演的“内容除外”，为“#FF5200”），
* “数据方”为 intv_input、stn_input、stn_output、dir_input 时， “数据方”/“ 日期”/“时间”/ “内容”的字体展示颜色为：#A6A6A6