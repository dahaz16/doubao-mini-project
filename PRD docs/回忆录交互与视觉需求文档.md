# 回忆录交互与视觉需求文档

Sketch 源文件见：'/Users/wangyituo/Documents/拓的文稿/项目/回忆录项目/回忆录代码项目/doubao-mini-project/PRD docs/回忆录原型_Antigravity.sketch'

## 一、 页面交互逻辑

本项目包含两个页面：**1. 首页** 和 **2. 采访页**。

### 1. 全局配置
*   **导航栏：** 采用微信官方透明导航栏配置，背景色透明，标题文字颜色根据背景深浅自适应。
*   **页面标题：** 首页无标题，采访页标题为“讲述中”。

### 2. 首页
*   **页面定位：** 小程序启动首屏。
*   **核心元素：**
    *   **大标题 (main_title)：** 感谢参与测试（固定文案）。
    *   **版本号 (version_number)：** 显示在大标题下方（版本号确定为 `v0.0.1 2026011401`，可随时修改）。
    *   **操作按钮组：** 位于屏幕底部。
        1.  **主按钮 (start_interview_btn)：** 开始讲述。
        2.  **副按钮 (view_memories_btn)：** 查看回忆（位于主按钮下方）。
*   **交互动作：**
    *   **点击任意按钮（start_interview_btn 或 view_memories_btn）：**
        *   **第一步：** 触发登录校验。
        *   **第二步：** 若用户未登录，拉起微信授权登录流程。
        *   **第三步：** 登录成功后，继续执行按钮原有逻辑。
    *   **逻辑分支：**
        *   **若点击开始讲述：** 跳转至 **采访页**。
        *   **若点击查看回忆：** 触发 **弹窗**（具体功能等待后续开发）。
            *   **弹窗内容：** 显示 AI 虚拟形象静态图、提示文字“当前功能阿拓正在调试中，将在下个测试版本中开放”、确认按钮“好的”。
            *   **弹窗行为：** 点击“好的”按钮，弹窗关闭。

### 3. 采访页
*   **页面布局结构：**
    *   **Top 区：** 放置 **AI 虚拟形象 (AI_Avatar)**，固定在页面顶部，不随内容移动。
    *   **Middle 区：** 弹性内容区。紧贴在 AI 虚拟形象下方。在开始播放 AI 语音时，流式输出当前最新一轮的 **AI 字幕内容 (AI_Subtitle_Bubble)**。
    *   **Bottom 区：** 页面底部操作栏，包含 **打字输入框 (input_field)**、控制按钮、**用户字幕气泡 (User_Subtitle_Bubble)**。需适配 iPhone 底部安全区。
*   **核心状态切换逻辑：**

    **A. 默认状态**
    *   **界面：** Middle 区显示 **AI 字幕气泡 (AI_Subtitle_Bubble)**。
    *   **底部：** 显示 **讲述按钮 (narration_btn)**、左侧显示 **切换键盘按钮 (switch_to_keyboard_btn)**。

    **B. 语音录制状态**
    *   **进入方式：** 点击 **讲述按钮 (narration_btn)**。
    *   **界面变化：**
        *   **音频指示器 (voice_indicator)：** 底部显示 60秒倒计时（格式 00:59）及动态声波纹动画。
        *   **实时字幕：** Middle 区下方显示 **用户字幕气泡 (User_Subtitle_Bubble)**。
    *   **操作：**
        *   **点击取消 (cancel_speak_btn)：** 清空录音，返回默认状态。
        *   **点击发送 (send_msg_btn)：** 发送文字，进入思考中状态。
        *   **倒计时结束：** 自动发送，进入思考中状态。

    **C. 键盘输入状态**
    *   **进入方式：** 点击 **切换键盘按钮 (switch_to_keyboard_btn)**。
    *   **界面变化：** 键盘弹起，Bottom 区被顶起。Top 区 **AI 虚拟形象 (AI_Avatar)** 保持不动。Middle 区显示用户正在输入的文字。
    *   **控件状态：** 显示 **打字输入框 (input_field)**。
    *   **数据保留逻辑：** 在语音和键盘模式间切换时，输入框内已有的文字必须保留，不可丢失。

    **D. 思考中状态**
    *   **进入方式：** 用户发送消息后。
    *   **界面变化：**
        *   **字幕板：** 气泡内容变为灰色“思考中...”。
        *   **动效：** 加载思考中动效。
        *   **按钮：** 底部按钮变灰禁用 (**narration_btn_disabled**)，文案变为“请稍等”。
    *   **结束：** 收到 AI 回复后，状态恢复，Middle 区更新为 AI 的新回复。

---

## 二、 页面视觉与样式规范

### 1. 全局技术实现
*   **背景流光：** 尝试使用 CSS3 Animation 代码实现。
    *   **色值：** 135度线性渐变，颜色为 `#FFF5F7` 到 `#F3F4F6` 到 `#ECF6FF`。
    *   **动画：** 缓动效果，呼吸感流动。
*   **阴影：** 所有按钮、气泡、弹窗统一参数：X轴0，Y轴4px，模糊8px，扩展0，颜色黑色，透明度25%。
*   **单位：** 全局使用 px 逻辑像素。
*   **字体：** 高对比度，清晰易读。

### 2. 圆角与形状规范
*   **AI 字幕气泡 (AI_Subtitle_Bubble) / 用户字幕气泡 (User_Subtitle_Bubble)：** 圆角 30px（平滑圆角）。
*   **按钮（含 voice_indicator 背景）：** 圆角 25px（平滑圆角）。
*   **弹框：** 圆角 30px（平滑圆角）。

### 3. 详细参数列表

#### A. 颜色
*   **主文字：** `#373737`
*   **思考中文字：** `#A6A6A6`
*   **输入框/气泡/声波背景：** 白色，透明度 90%。
*   **按钮背景：** 纯白色。

#### B. 尺寸与字号
*   **首页标题：** 56px
*   **首页版本号：** 18px
*   **通用主字号：** 22px（AI 字幕需加粗，用户输入文字常规）。
*   **按钮文案/倒计时：** 20px（加粗）。
*   **AI 虚拟形象：** 宽 130px，高 170px。
*   **长条形按钮/气泡：** 高度 50px，左右边距各 20px。
*   **圆形按钮：** 直径 50px。

#### C. 采访页特殊元素定义
*   **AI 虚拟形象容器 (AI_Avatar)：**
    *   目前格式未定（GIF / 视频 / Lottie），代码需预留通用的容器组件，暂用图片占位。
*   **音频指示器 (voice_indicator) UI 定义：**
    *   **整体背景：** 白色，透明度 90%，圆角 25px，高度 50px。
    *   **声波条样式：** 位于背景垂直居中。每个声波条宽度 4px，圆角 2px，颜色为 `#373737`。
    *   **展示逻辑：** 约 5-10 个声波条并排，根据音量或模拟随机高度进行跳动。

#### D. 输入框高度自适应逻辑
*   **初始高度：** 1 行文字高度。
*   **增长逻辑：** 随文字增多自动长高。
*   **最大高度：** 限制为 5 行。
*   **滚动逻辑：** 第 6 行起高度不再增加，内部开启滚动，并自动定位到最新一行文字。

#### E. 图片资源与控件命名
资源路径:'/Users/wangyituo/Documents/拓的文稿/项目/回忆录项目/回忆录代码项目/doubao-mini-project/UI assets'
请在代码中引用以下命名：
1.  **AI 形象：** `AI_Avatar`
2.  **切换键盘（可用）：** `switch_to_keyboard_btn`
3.  **切换键盘（不可用）：** `switch_to_keyboard_btn_disabled`
4.  **切换语音（可用）：** `switch_to_voice_btn`
5.  **切换语音（不可用）：** `switch_to_voice_btn_disabled`
6.  **取消讲话按钮：** `cancel_speak_btn`
7.  **发送按钮：** `send_msg_btn`
8.  **音频指示器（波形和倒计时）：** `voice_indicator`
9.  **讲述按钮（可用）：** `narration_btn`
10. **讲述按钮（不可用）：** `narration_btn_disabled`
11. **打字输入框（可用）：** `input_field`
12. **打字输入框（不可用）：** `input_filed_disabled`
13. **思考中动效：** `thinking_state_gif`
14. **关闭图标：** `icon_close`